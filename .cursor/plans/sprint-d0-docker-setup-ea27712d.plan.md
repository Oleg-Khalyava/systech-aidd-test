<!-- ea27712d-039c-4068-aa71-a935459bfe98 0a34eac3-937c-4437-8956-7d391b285af8 -->
# –ü–ª–∞–Ω –°–ø—Ä–∏–Ω—Ç–∞ D0: Basic Docker Setup

## –¶–µ–ª—å

–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ–µ–∫—Ç–∞ (Bot, API, Frontend) –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ `docker-compose up` –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–µ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å Dockerfile –¥–ª—è Bot

**–§–∞–π–ª:** `Dockerfile`

–¢–µ–∫—É—â–∏–π Dockerfile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç multi-stage build, —á—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ –¥–ª—è MVP. –ù—É–∂–Ω–æ:

- –£–±—Ä–∞—Ç—å multi-stage —Å–±–æ—Ä–∫—É
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π –æ–±—Ä–∞–∑ `python:3.11-slim`
- WORKDIR /app
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ uv –Ω–∞–ø—Ä—è–º—É—é
- –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã (src/, llm/, prompts/, alembic/)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å entrypoint.sh –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
- CMD —á–µ—Ä–µ–∑ entrypoint.sh
- –†–∞–∑–º–µ—Ä: ~15-20 —Å—Ç—Ä–æ–∫

### 2. –°–æ–∑–¥–∞—Ç—å Dockerfile –¥–ª—è API

**–§–∞–π–ª:** `api/Dockerfile`

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π Dockerfile –¥–ª—è FastAPI —Å–µ—Ä–≤–∏—Å–∞:

- –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑: `python:3.11-slim`
- WORKDIR /app
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ uv
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ api/, llm/, prompts/
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ alembic/ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π (API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –ë–î)
- EXPOSE 8000
- CMD –∑–∞–ø—É—Å–∫–∞: `uvicorn api.api_main:app --host 0.0.0.0 --port 8000`

### 3. –°–æ–∑–¥–∞—Ç—å Dockerfile –¥–ª—è Frontend

**–§–∞–π–ª:** `frontend/Dockerfile`

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π Dockerfile –¥–ª—è Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

- –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑: `node:20-alpine`
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pnpm
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `pnpm install`
- –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞: `pnpm dev` (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- –ü–æ—Ä—Ç: 3000

### 4. –û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml

**–§–∞–π–ª:** `docker-compose.yml`

–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞:

- **bot** (telegram-bot) - –ø–æ—Ä—Ç –Ω–µ –Ω—É–∂–µ–Ω, —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram API
- **api** (backend-api) - –ø–æ—Ä—Ç 8000:8000
- **frontend** (frontend-web) - –ø–æ—Ä—Ç 3000:3000

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

- –û–±—â–∏–π volume –¥–ª—è SQLite –ë–î: `./data:/app/data`
- –û–±—â–∏–π volume –¥–ª—è –ª–æ–≥–æ–≤: `./logs:/app/logs`
- env_file –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- restart: unless-stopped
- depends_on: API –∏ Frontend –∑–∞–≤–∏—Å—è—Ç –æ—Ç Bot (–ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–æ—Ç–æ–º)

### 5. –°–æ–∑–¥–∞—Ç—å .dockerignore —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

**–§–∞–π–ª—ã:**

- `.dockerignore` (–∫–æ—Ä–µ–Ω—å, –¥–ª—è Bot)
- `api/.dockerignore` (–¥–ª—è API)
- `frontend/.dockerignore` (–¥–ª—è Frontend)

–î–ª—è Bot (.dockerignore –≤ –∫–æ—Ä–Ω–µ):

- –†–∞—Å—à–∏—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª
- –ò—Å–∫–ª—é—á–∏—Ç—å: api/, frontend/, htmlcov/, devops/, docs/, tests/
- –û—Å—Ç–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Python, git, IDE, logs

–î–ª—è API (api/.dockerignore):

- Python –∫—ç—à –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- frontend/, htmlcov/, devops/, docs/, tests/
- Git, IDE —Ñ–∞–π–ª—ã, –ª–æ–≥–∏, .env
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ markdown —Ñ–∞–π–ª—ã

–î–ª—è Frontend (frontend/.dockerignore):

- node_modules/, .next/, out/
- .git/, *.md, doc/
- IDE —Ñ–∞–π–ª—ã (.vscode/, .idea/), –ª–æ–≥–∏, .env
- Python —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏ –∏–∑ –∫–æ—Ä–Ω—è

### 6. –î–æ–±–∞–≤–∏—Ç—å Make –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Docker

**–§–∞–π–ª:** `Makefile`

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª "üê≥ Docker commands":

- `make docker-up` - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (docker-compose up -d)
- `make docker-down` - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (docker-compose down)
- `make docker-restart` - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
- `make docker-logs` - –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (docker-compose logs -f)
- `make docker-status` - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (docker-compose ps)
- `make docker-clean` - –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ volumes

### 7. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–§–∞–π–ª:** `README.md`

–î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ —Ä–∞–∑–¥–µ–ª "üê≥ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker":

- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (Docker, Docker Compose)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞
- –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞: `make docker-up` –∏–ª–∏ `docker-compose up`
- –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–ª–æ–≥–∏, —Å—Ç–∞—Ç—É—Å, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
- URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º

### 8. –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω .env —Ñ–∞–π–ª–∞

**–§–∞–π–ª:** `.env.example`

–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

- BOT_TOKEN (Telegram bot token)
- OPENAI_API_KEY
- DATABASE_URL (sqlite:///data/bot.db)
- API_HOST, API_PORT
- FRONTEND_URL

### 9. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `docker-compose up` –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

**Bot:**

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `docker-compose ps`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫: `docker-compose logs bot`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å —É—Å–ø–µ—à–Ω–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ë–î —Å–æ–∑–¥–∞–ª–∞—Å—å –≤ `./data/bot.db`

**API:**

- –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ http://localhost:8000/docs
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `/stats?period=week`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ API –æ—Ç–≤–µ—á–∞–µ—Ç 200 OK

**Frontend:**

- –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ http://localhost:3000
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API (dashboard –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑–∞–ø—É—â–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ `./logs/`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ volume –¥–ª—è –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

‚úÖ –ö–æ–º–∞–Ω–¥–∞ `docker-compose up` –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ 3 —Å–µ—Ä–≤–∏—Å–∞
‚úÖ Frontend –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000
‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000/docs
‚úÖ Bot —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram
‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â—É—é SQLite –ë–î
‚úÖ Make –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏ –ø–æ–Ω—è—Ç–Ω–∞

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ Dockerfiles –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–µ (single-stage)
- –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—ç—Ç–æ –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ø—Ä–∏–Ω—Ç–∞—Ö)
- –§–æ–∫—É—Å –Ω–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä–µ –æ–±—Ä–∞–∑–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ–º dev —Ä–µ–∂–∏–º –¥–ª—è Next.js (–Ω–µ production build)

### To-dos

- [ ] –£–ø—Ä–æ—Å—Ç–∏—Ç—å Dockerfile –¥–ª—è backend (—É–±—Ä–∞—Ç—å multi-stage build)
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π Dockerfile –¥–ª—è API —Å–µ—Ä–≤–∏—Å–∞
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π Dockerfile –¥–ª—è Frontend —Å–µ—Ä–≤–∏—Å–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml - –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ 3 —Å–µ—Ä–≤–∏—Å–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- [ ] –û–±–Ω–æ–≤–∏—Ç—å .dockerignore –¥–ª—è backend –∏ —Å–æ–∑–¥–∞—Ç—å –¥–ª—è frontend
- [ ] –î–æ–±–∞–≤–∏—Ç—å Docker –∫–æ–º–∞–Ω–¥—ã –≤ Makefile (up, down, logs, status, clean)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å README.md —Å —Ä–∞–∑–¥–µ–ª–æ–º –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —á–µ—Ä–µ–∑ Docker
- [ ] –°–æ–∑–¥–∞—Ç—å .env.example —Å —à–∞–±–ª–æ–Ω–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è